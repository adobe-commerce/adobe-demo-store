/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as e,jsxs as a}from"@dropins/tools/preact-jsx-runtime.js";import{c as S}from"../chunks/getRecommendations.js";import{useCallback as V,useState as b}from"@dropins/tools/preact-compat.js";import{Slot as _,classes as l,VComponent as j}from"@dropins/tools/lib.js";import{Button as w,Icon as N,Image as C}from"@dropins/tools/components.js";import"@dropins/tools/fetch-graphql.js";const R=({items:t,className:s,children:o,slots:c,...u})=>{const i=V(({items:n,slots:r})=>n==null?void 0:n.map(m=>{const[h]=b(()=>({sku:m.sku})),[p]=b(()=>!0),d={values:h,valid:p};return e(B,{product:m,actions:e(_,{name:"Actions",slot:r==null?void 0:r.Actions,context:{...d,appendButton(f){this._registerMethod((...v)=>{const g=f(...v);if(!g)return;const{text:x,icon:y,...P}=g,k=e(w,{type:"button",...P,icon:y&&e(N,{source:y}),children:x});this._setProps(I=>({children:[...I.children||[],k]}))})}}})})}),[]);return a("div",{...u,className:l(["recs-product-list",s]),children:[e(i,{items:t,slots:c}),o]})},A=({unit:t,slots:s,className:o,children:c,...u})=>a("div",{...u,className:l(["recs-rec-unit",o]),children:[e(R,{items:t==null?void 0:t.productsView,slots:s}),c]}),B=({product:t,actions:s,className:o,children:c,...u})=>{var r;const i=`${(r=t.images[0])==null?void 0:r.url}?width=300&format=jpg&optimize=medium`,n=["/products",t.urlKey,t.sku].join("/");return a("div",{...u,className:l(["recs-product-item",o]),children:[a("a",{href:`${n}`,children:[e(C,{title:t.name,alt:t.name,src:i,width:300,height:375},i),e("span",{children:t.name})]}),e("span",{class:"product-grid-cta"}),s&&e(j,{node:s,className:l(["recs-product-item__buttons"])}),c]})},H=({pageType:t,currentSku:s,cartSKUs:o,category:c,userPurchaseHistory:u,userViewHistory:i,children:n,initialData:r,slots:m,config:h,...p})=>a("div",{...p,children:[r==null?void 0:r.map(d=>e(A,{unit:d,slots:m},d.unitId)),n]});H.getInitialData=async function({pageType:t,currentSku:s,cartSKUs:o,category:c,userPurchaseHistory:u,userViewHistory:i,config:n}){return S(t,s,o,c,u,i,n)};export{H as RecommendationList,H as default};
